   <!-- Content Wrapper. Contains page content -->
   @model IEnumerable<LegalAndGeneralConsultantCRM.ViewModels.Leads.MessageVM>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
 

<style>
	 /* Style for the Gmail icon */
        .gmail-icon {
            font-size: 30px;
            color: #D44638;
            cursor: pointer;
        }
	.social-media-container {
    display: flex;
    justify-content: center;  /* Center the icons horizontally */
    align-items: center;      /* Center the icons vertically */
    gap: 15px;                /* Add space between each icon */
    margin-top: 3%;           /* Ensure container is centered */
    padding: 20px;            /* Add padding around the container */
             /* Full viewport height to center vertically */
}

.social-media-container img {
    width: 50px;              /* Set desired width */
    height: 50px;             /* Set desired height */
    object-fit: cover;        /* Ensures images maintain aspect ratio */
}

	#activity-log-container {
		max-height: 523px; /* Adjust the height as needed */
		overflow-y: auto;
		padding-right: 10px; /* To accommodate for the scrollbar */
	}

		/* Customize the scrollbar for WebKit browsers (Chrome, Safari) */
		#activity-log-container::-webkit-scrollbar {
			width: 6px; /* Slim scrollbar width */
		}

		#activity-log-container::-webkit-scrollbar-thumb {
			background-color: #888; /* Color of the scrollbar thumb */
			border-radius: 10px; /* Rounded scrollbar thumb */
			border: 2px solid #f0f0f0; /* Adds a border to create space between the thumb and track */
		}

			#activity-log-container::-webkit-scrollbar-thumb:hover {
				background-color: #555; /* Darker color when hovered */
			}

		#activity-log-container::-webkit-scrollbar-track {
			background-color: #f0f0f0; /* Background of the scrollbar track */
			border-radius: 10px; /* Rounded scrollbar track */
		}

	/* For Firefox */
	#activity-log-container {
		scrollbar-width: thin; /* Slim scrollbar width */
		scrollbar-color: #888 #f0f0f0; /* Thumb color and track color */
	}

	/* Scrollbar for IE and Edge */
	#activity-log-container {
		-ms-overflow-style: -ms-autohiding-scrollbar; /* Auto-hide scrollbar in Edge and IE */
	}


</style>
<style>
	[type=button]:not(:disabled), [type=reset]:not(:disabled), [type=submit]:not(:disabled), button:not(:disabled) {
		cursor: pointer;
		background: #4e0973;
		color: white;
	}</style>
<div class="content-wrapper">
	<div class="content-wrapper-before"></div>
	<div class="container-full">
		<!-- Main content -->
		<section class="content">
			<div class="row">
				<div class="col-12 col-xl-4">
					<div class="box">
						<div class="box-header no-border">
							<h4 class="box-title">My Leads</h4>
							<ul class="box-controls pull-right">
								<li class="dropdown">
									<div class="dropdown-menu dropdown-menu-right">
										<a class="dropdown-item" href="#"><i class="ti-import"></i> Import</a>
										<a class="dropdown-item" href="#"><i class="ti-export"></i> Export</a>
										<a class="dropdown-item" href="#"><i class="ti-printer"></i> Print</a>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" href="#"><i class="ti-settings"></i> Settings</a>
									</div>
								</li>
							</ul>
						</div>
						<div class="box-body px-0">
							<div class="overflow-h" style="height: 339px;">
								<div id="chart"></div>

							</div>
						</div>
						<div class="box-body py-0">
							<div class="row">
								<div class="col-6">
									<div class="d-flex align-items-center mb-30">
										<div class="mr-15 bg-primary-light h-50 w-50 l-h-60 rounded text-center">
											<span class="icon-Library font-size-24"><span class="path1"></span><span class="path2"></span></span>
										</div>
										<div class="d-flex flex-column font-weight-500">
											<a href="#" class="text-dark hover-primary mb-1 font-size-16">  Hot Leads</a>
										</div>
									</div>
								</div>
								<div class="col-6">
									<div class="d-flex align-items-center mb-30">
										<div class="mr-15 bg-danger-light h-50 w-50 l-h-60 rounded text-center">
											<span class="icon-Write font-size-24"><span class="path1"></span><span class="path2"></span></span>
										</div>
										<div class="d-flex flex-column font-weight-500">
											<a href="#" class="text-dark hover-danger mb-1 font-size-16"> Future Leads</a>
										</div>
									</div>
								</div>
								<div class="col-6">
									<div class="d-flex align-items-center mb-30">
										<div class="mr-15 bg-success-light h-50 w-50 l-h-60 rounded text-center">
											<span class="icon-Group-chat font-size-24"><span class="path1"></span><span class="path2"></span></span>
										</div>
										<div class="d-flex flex-column font-weight-500">
											<a href="#" class="text-dark hover-success mb-1 font-size-16">Dead Leads</a>
										</div>
									</div>
								</div>
								<div class="col-6">
									<div class="d-flex align-items-center mb-30">
										<div class="mr-15 bg-info-light h-50 w-50 l-h-60 rounded text-center">
											<span class="icon-Attachment1 font-size-24"><span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span></span>
										</div>
										<div class="d-flex flex-column font-weight-500">
											<a href="#" class="text-dark hover-info mb-1 font-size-16">Converted  </a>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-xl-4 col-12">
					<div class="box">
						<div class="box-header no-border">
							<h4 class="box-title">  Activity Logs</h4>
							<ul class="box-controls pull-right">
								<li class="dropdown">
									<div class="dropdown-menu dropdown-menu-right">
										<a class="dropdown-item" href="#"><i class="ti-import"></i> Import</a>
										<a class="dropdown-item" href="#"><i class="ti-export"></i> Export</a>
										<a class="dropdown-item" href="#"><i class="ti-printer"></i> Print</a>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" href="#"><i class="ti-settings"></i> Settings</a>
									</div>
								</li>
							</ul>
						</div>

						<div class="box-body p-0">
							<div id="revenue6" class="text-dark"></div>
						</div>
						<div class="box-body pt-0">
							<div id="activity-log-container" class="container">
								<!-- Activity logs will be dynamically injected here -->
							</div>


						</div>
					</div>

				</div>
				<div class="col-xl-4 col-12">
					<div class="box">
						<div class="box-header">
							<h4 class="box-title">  Meeting & Events</h4>
						</div>
						<div class="box-body">
							<div class="row">


								<div id="calendarr"></div>

							</div>
						</div>
					</div>
					<div class="box box-body ull-up">
						<div class="flexbox align-items-end">
							<div>
								<span class="font-size-30 countnm">@ViewBag.HotLeadCount</span>
								<h6 class="text-uppercase text-dark-50 mb-0">Total Hot Leads</h6>
							</div>
							<span class="icon-User font-size-80 text-info"><span class="path1"></span><span class="path2"></span></span>
						</div>
					</div>
				</div>



				<div class="col-xl-3 col-lg-6 col-12">
					<div class="box">
						<div class="box-body">
							<div class="d-flex">
								<h3 class="font-weight-400 mb-0">@ViewBag.MyLead </h3>
								<span class="badge badge-primary badge-pill align-self-center ml-auto">My Leads</span>
							</div>
							<div>
								My Total Leads
							</div>
						</div>
						<div class="chart">
							<div id="spark1"></div>
						</div>
					</div>
				</div>
				<div class="col-xl-3 col-lg-6 col-12">
					<div class="box">
						<div class="box-body">
							<div class="d-flex">
								<h3 class="font-weight-400 mb-0">@ViewBag.HotLeadCount</h3>
								<span class="badge badge-primary badge-pill align-self-center ml-auto">Hot Leads  </span>

							</div>
							<div>
								Total Hot Leads
							</div>
						</div>
						<div class="chart">
							<div id="spark2"></div>
						</div>
					</div>
				</div>
				<div class="col-xl-3 col-lg-6 col-12">
					<div class="box">
						<div class="box-body">
							<div class="d-flex">
								<h3 class="font-weight-400 mb-0">@ViewBag.dead</h3>
								<span class="badge badge-primary badge-pill align-self-center ml-auto"> Dead Leads  </span>


							</div>
							<div>
								Total Dead Leads
							</div>
						</div>
						<div class="chart">
							<div id="spark3"></div>
						</div>
					</div>
				</div>
				<div class="col-xl-3 col-lg-6 col-12">
					<div class="box">
						<div class="box-body">
							<div class="d-flex">
								<h3 class="font-weight-400 mb-0">@ViewBag.Future</h3>
								<span class="badge badge-primary badge-pill align-self-center ml-auto">Future Leads  </span>

							</div>
							<div>
								Total Future Leads
							</div>
						</div>
						<div class="chart">
							<div id="spark4"></div>
						</div>
					</div>
				</div>
				<div class="col-xl-12 col-12">
					<div class="box">
				<div class="box-header">
							<h4 class="box-title">		 <!-- Gmail Icon -->
Social Media LInks</h4></div>
						 <div class="social-media-container">
							           
            <a href="@ViewBag.Facebook" target="_blank" onclick="checkLink('@ViewBag.Facebook')">
                <img src="https://tse2.mm.bing.net/th?id=OIP.5qAQWZ6Y9LFzVBfW4k7k7gHaHa&pid=Api&P=0&h=220" alt="Facebook">
            </a>
            <a href="@ViewBag.Twitter" target="_blank" onclick="checkLink('@ViewBag.Twitter')">
                <img src="https://www.iconpacks.net/icons/2/free-twitter-logo-icon-2429-thumb.png" alt="Twitter">
            </a>
            <a href="@ViewBag.Instagram" target="_blank" onclick="checkLink('@ViewBag.Instagram')">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRwH--J-ZMUg8puNfUxE6YXQi3yVHuAORDxow&s" alt="Instagram">
            </a>
            <a href="@ViewBag.TikTok" target="_blank" onclick="checkLink('@ViewBag.TikTok')">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRcBF4ESnDHJlNtvwg1oUAdZ81vKuftiIb7HA&s" alt="TikTok">
            </a>
            <a href="@ViewBag.LinkedIn" target="_blank" onclick="checkLink('@ViewBag.LinkedIn')">
                <img src="https://cdn-icons-png.flaticon.com/512/174/174857.png" alt="LinkedIn">
            </a>
            <a href="@ViewBag.YouTube" target="_blank" onclick="checkLink('@ViewBag.YouTube')">
                <img src="https://t3.ftcdn.net/jpg/04/74/05/94/360_F_474059464_qldYuzxaUWEwNTtYBJ44VN89ARuFktHW.jpg" alt="YouTube">
            </a>
            <a href="@ViewBag.Snapchat" target="_blank" onclick="checkLink('@ViewBag.Snapchat')">
                <img src="https://img.freepik.com/premium-vector/square-snapchat-logo-isolated-white-background_469489-894.jpg" alt="Snapchat">
            </a>
            <a href="@ViewBag.Pinterest" target="_blank" onclick="checkLink('@ViewBag.Pinterest')">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ4bbV81EyBpAdTCq2dqUwwAHUCWDr9qvrscg&s" alt="Pinterest">
            </a>
            <a href="@ViewBag.Reddit" target="_blank" onclick="checkLink('@ViewBag.Reddit')">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTOeXPXmHTgYRcALn46DZW9aAgZrvNqJk0AJg&s" alt="Reddit">
            </a>
           
        </div>

						<div class="box-header">
							<h4 class="box-title">
								My Converted Leads Summary

							</h4>
						</div>
						<div class="box-body p-0">
							<div class="table-responsive">
								<table id="brandTables" class="table table-bordered table-hover display nowrap margin-top-10 w-p100">
									<thead>
										<tr>
											<th style="background-color: #4e0973;color:white;">Name</th>
											<th style="background-color: #4e0973;color:white;">Email</th>
											<th style="background-color: #4e0973;color:white;">Gender</th>
											<th style="background-color: #4e0973;color:white;"> Phone Number</th>
											<th style="background-color: #4e0973;color:white;">Status</th>

										</tr>
									</thead>
									<tbody>
									</tbody>

								</table>
							</div>
						</div>
					</div>
				</div>
			 
			</div>
		</section>
		<!-- /.content -->
	</div>
</div>

<!-- /.content-wrapper -->
<div class="modal fade" id="eventModal" tabindex="-1" role="dialog" aria-labelledby="eventModalLabel" aria-hidden="true">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="eventModalLabel">Meeting Details</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<form id="eventForm">
				<input type="hidden" id="eventId" name="eventId">

				<div class="modal-body">
					<div class="form-group">
						<label for="leadId">Meeting or Event Name</label>
						<input type="text" class="form-control" id="name" name="name" required>

					</div>
					<div class="form-group">
						<label for="eventDescription">Description</label>
						<textarea class="form-control" id="eventDescription" name="description" rows="3" required></textarea>
					</div>
					<div class="form-group">
						<label for="eventStart">Event Date</label>
						<input type="text" class="form-control" id="eventStart" name="eventStart" required>
					</div>
					<div class="form-group">
						<label for="eventThemeColor">Theme Color</label>
						<select class="form-control" id="eventThemeColor" name="themeColor" required>
							<option value="red">Red</option>
							<option value="blue">Blue</option>
							<option value="green">Green</option>
							<option value="yellow">Yellow</option>
						</select>
					</div>
				</div>
				<div class="modal-footer">
					<button type="submit" class="btn btn-primary">Save</button>
					<button type="button" class="btn btn-danger" id="deleteEventButton">Delete</button>
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
				</div>
			</form>
		</div>
	</div>
</div>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

@section Scripts {
	<script>
		$(document).ready(function () {
			// Initialize brandTables DataTable only if not already initialized
			if (!$.fn.DataTable.isDataTable('#brandTables')) {
				$('#brandTables').DataTable({
					"ajax": {
						"url": "/Employee/MyLead/GetConvertedLead",
						"type": "GET",
						"datatype": "json"
					},
					"columns": [
						{ "data": "fullName", "name": "Name", "autoWidth": true },
						{ "data": "email", "autoWidth": true },
						{ "data": "gender", "autoWidth": true },
						{ "data": "phoneNumber", "name": "Phone No", "autoWidth": true },
						{
							"data": "followUpStatus",
							"autoWidth": true,
							"render": function (data, type, row) {
								if (data === "Converted Lead") {
									return '<span class="badge badge-pill bg-success">Converted Lead</span>';
								} else if (data === "Dead Lead") {
									return '<span class="badge badge-pill bg-danger">Dead Lead</span>';
								} else if (data === "Cold Lead") {
									return '<span class="badge badge-pill bg-dark">Cold Lead</span>';
								} else if (data === "Future Lead") {
									return '<span class="badge badge-pill bg-secondary">Future Lead</span>';
								} else if (data === "Hot Lead") {
									return '<span class="badge badge-pill bg-primary">Hot Lead</span>';
								} else if (data === "Warm Lead") {
									return '<span class="badge badge-pill bg-info">Warm Lead</span>';
								} else {
									return '<span class="badge badge-pill bg-warning">Pending Lead</span>';
								}
							}
						}
					]
				});
			}

			// FullCalendar initialization
			$('#calendarr').fullCalendar({
				header: {
					left: 'prev,next today',
					center: 'title',
					right: 'month,agendaWeek,agendaDay'
				},
				editable: true,
				events: '/Employee/Meeting/GetEvents',
				eventClick: function (calEvent, jsEvent, view) {
					$('#eventModalLabel').text('Edit Meeting');
					$('#name').val(calEvent.title);
					$('#eventDescription').val(calEvent.description);
					$('#eventStart').val(moment(calEvent.start).format('YYYY-MM-DD'));
					$('#eventThemeColor').val(calEvent.color);
					$('#eventId').val(calEvent.id);
					$('#eventModal').modal('show');
				},
				dayClick: function (date, jsEvent, view) {
					$('#eventModalLabel').text('Create Meeting');
					$('#eventDescription').val('');
					$('#name').val('');
					$('#eventStart').val(moment(date).format('YYYY-MM-DD'));
					$('#eventThemeColor').val('red');
					$('#eventId').val('');
					$('#eventModal').modal('show');
				}
			});

			// Handle form submission for creating or updating events
			$('#eventForm').submit(function (event) {
				event.preventDefault();
				var eventId = $('#eventId').val();
				var eventData = {
					CalendarEventId: eventId,
					Description: $('#eventDescription').val(),
					Name: $('#name').val(),
					EventDate: $('#eventStart').val(),
					ThemeColor: $('#eventThemeColor').val()
				};

				var url = eventId ? '/Employee/Meeting/UpdateEvent' : '/Employee/Meeting/AddEvent';

				$.ajax({
					type: 'POST',
					url: url,
					data: eventData,
					success: function (data) {
						if (data.success) {
							$('#calendarr').fullCalendar('refetchEvents');
							$('#eventModal').modal('hide');
						} else {
							alert('Failed to save event.');
						}
					},
					error: function () {
						alert('Error occurred. Please try again.');
					}
				});
			});
		
			// Handle event delete
			$('#deleteEventButton').click(function () {
				var eventId = $('#eventId').val();

				if (eventId) {
					if (confirm('Are you sure you want to delete this event?')) {
						$.ajax({
							type: 'POST',
							url: '/Employee/Meeting/DeleteEvent',
							data: { id: eventId },
							success: function (data) {
								if (data.success) {
									$('#calendarr').fullCalendar('refetchEvents');
									$('#eventModal').modal('hide');
								} else {
									alert('Failed to delete event.');
								}
							},
							error: function () {
								alert('Error occurred. Please try again.');
							}
						});
					}
				}
			});

			// Fetch user activity logs
			$.ajax({
				url: '/Employee/EmployeeDashboard/GetUserActivity',
				type: 'GET',
				success: function (response) {
					var container = $('#activity-log-container');
					container.empty();

					if (response.data && response.data.length > 0) {
						$.each(response.data, function (index, activityLog) {
							var logHtml = `
										<div class="d-flex align-items-center mb-20">
											<div class="d-flex flex-column flex-grow-1 mr-2 font-weight-500">
												<div class="row mb-2">
													<div class="col-auto">
														<img src="https://adminto-dashboard-template.multipurposethemes.com/images/svg-icon/color-svg/002-google.svg" class="h-30" alt="">
													</div>
													<div class="col">
														<a href="#" class="text-dark hover-primary mb-1 font-size-16">
															User: ${activityLog.userName}
														</a>
														<div class="text-fade">
															${new Date(activityLog.activityLogDate).toLocaleString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' })}
														</div>
														<div>
															Action: ${activityLog.action}
														</div>
														<div>
															Lead: ${activityLog.fullName}
														</div>
													</div>
												</div>
												<hr />
											</div>
										</div>`;
							container.append(logHtml);
						});
					} else {
						container.append('<p>No activity logs found for today.</p>');
					}
				},
				error: function () {
					$('#activity-log-container').html('<p>There was an error loading the activity logs.</p>');
				}
			});

			  var options = {
					 series: [{
							name: 'Leads',
							data: [
		@ViewBag.HotLeadCount,  // Hot Lead count
		@ViewBag.dead,          // Dead Lead count
		@ViewBag.Future         // Future Lead count
							]
						}],
						   chart: {
							type: 'bar',  // Type of chart
							height: 350
						   },
							  plotOptions: {
									 bar: {
											horizontal: false,
										 columnWidth: '55%',
										
										},
								 },
								 dataLabels: {
										enabled: true
									},
									stroke: {
										   show: true,
										width: 2,
									 colors: ['transparent']
							  },
						   xaxis: {
							categories: ['Hot Leads', 'Dead Leads', 'Future Leads'], // Labels for each status
						},
					 yaxis: {
						title: {
							 text: 'Count of Leads'
						 }
				  },
				   fill: {
						opacity: 1
					},
					tooltip: {
						y: {
							formatter: function (val) {
								return val + " leads"
							}
						}
					},
					colors: ["#5949d6", "#fb3d4e", "#2a8853"], // Customize colors for each lead status
				};

				var chart = new ApexCharts(document.querySelector("#chart"), options);
				chart.render();
			});
	</script>
}


