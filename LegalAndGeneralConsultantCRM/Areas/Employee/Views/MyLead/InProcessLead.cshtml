<head>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.min.css">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        .country-code {
            width: 120px; /* Adjust width as needed */
        }

        .phone-number {
            flex: 1; /* Takes up the remaining space */
        }

        .icon-container {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }

        .tooltip-text {
            visibility: hidden;
            width: 60px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 5px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            bottom: 125%; /* Position the tooltip above the icon */
            left: 50%;
            margin-left: -30px; /* Center the tooltip */
            opacity: 0;
            transition: opacity 0.3s;
            white-space: nowrap; /* Prevent text wrapping */
        }

        .icon-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

    </style>
</head>
<div class="content-wrapper">
    <div class="content-wrapper-before"></div>
    <div class="container-full">

        <!-- Main content -->
        <section class="content">
            <!-- Content Header (Page header) -->
            <div class="content-header">
                <div class="d-flex align-items-center">
                    <div class="w-p100 d-md-flex align-items-center justify-content-between">
                        <h3 class="page-title">   </h3>
                        <div class="d-inline-block align-items-center">
                            <nav>
                                <ol class="breadcrumb">
                                </ol>
                            </nav>
                        </div>
                    </div>

                </div>
            </div>
            <div class="row">

                <div class="col-12">
                    <div class="box">
                        <div class="box-header with-border">
                            <h3 class="box-title">My Leads </h3>
                            <div class="float-right">
                                <a href="#" data-toggle="modal" data-target="#add-new-events" class="btn btn-primary btn-block my-10">
                                    <i class="ti-plus"></i> Add New Lead
                                </a>

                            </div>
                        </div>



                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="table-responsive">
                                <table id="leadTable" class="table table-bordered table-hover display nowrap margin-top-10 w-p100">
                                    <thead>
                                        <tr>
                                            <th style="background-color: #4e0973;color:white;">Name</th>
                                            <th style="background-color: #4e0973;color:white;">Email</th>
                                            <th style="background-color: #4e0973;color:white;">Gender</th>
                                            <th style="background-color: #4e0973;color:white;">Phone Number</th>
                                            <th style="background-color: #4e0973;color:white;">City</th>
                                            <th style="background-color: #4e0973;color:white;">Status</th>

                                            <th style="background-color: #4e0973;color:white;">Follow-Ups</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                </div>
            </div>

        </section>

    </div>
</div>

<div class="modal fade none-border" id="add-new-events">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"><strong>Add</strong> Lead</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body">
                <form asp-action="LeadForm" method="post" asp-area="Employee" asp-controller="MyLead" role="form">
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">First Name</label>
                            <input id="firstName" class="form-control form-white" placeholder="Enter name" type="text" name="FirstName" />
                        </div>
                        <div class="col-md-6">
                            <label class="control-label">Last Name</label>
                            <input id="lastName" class="form-control form-white" placeholder="Enter name" type="text" name="LastName" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Email</label>
                            <input id="email" class="form-control form-white" placeholder="Enter email" type="email" name="Email" required />
                        </div>
                        <div class="col-md-6">
                            <label class="control-label">Gender</label>
                            <select id="gender" class="form-control form-white" name="Gender">
                                <option value="" disabled>-- Select Gender --</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Phone Number</label>
                            <br />
                            <input id="phoneNumber" class="form-control form-white" placeholder="Enter phone number" type="text" name="PhoneNumber" style="padding-right:124px;" />
                        </div>
                        <div class="col-md-6">
                            <label class="control-label">Phone Number 2</label>
                            <br />
                            <input id="phoneNumber2" class="form-control form-white" placeholder="Enter phone Number 2" type="text" name="PhoneNumber2" style="padding-right:124px;" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Lead Source</label>
                            <select id="leadSource" class="form-control form-white form-select" name="LeadSource">
                                <option value="">Select lead source</option>
                                <option value="Social Media">Social Media</option>
                                <option value="Website">Website</option>
                                <option value="Event">Event</option>
                                <option value="Walk in">Walk in</option>
                                <option value="Partner/Referral">Partner/Referral</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="col-md-6" style="display:none" id="show">
                            <label class="control-label">Source Detail for others</label>
                            <input type="text" class="form-control" name="LeadSour" id="notes" placeholder="Notes">

                        </div>
                        <div class="col-md-6">
                            <label class="control-label">Notes</label>
                            <textarea type="text" class="form-control" name="Notes" id="notes" placeholder="Notes"></textarea>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <h2>Address</h2>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group col-md-6" style="display:none;">
                            <label>Suit Number/Apt Number</label>
                            <input type="text" class="form-control" name="Apt" id="apt" placeholder="Apartment Number">
                        </div>
                        <div class="form-group col-md-6">
                            <label>Street 1 Address</label>
                            <input type="text" class="form-control" name="Street1" id="street1" placeholder="Street 1">
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group col-md-6">
                            <label>Street 2 Address</label>
                            <input type="text" class="form-control" name="Street2" id="street2" placeholder="Street 2">
                        </div>
                        <div class="form-group col-md-6">
                            <label>City</label>
                            <input type="text" class="form-control" name="City" id="city" placeholder="City">
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group col-md-6">
                            <label>State</label>
                            <input type="text" class="form-control" name="State" id="state" placeholder="State">
                        </div>
                        <div class="form-group col-md-6">
                            <label>Zip Code</label>
                            <input type="text" class="form-control" name="ZipCode" id="zipCode" placeholder="Zip Code">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary" id="saveLeadBtn">Save</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var input1 = document.querySelector("#phoneNumber");
            var input2 = document.querySelector("#phoneNumber2");

            // Initialize intlTelInput for Phone Number 1
            var iti1 = window.intlTelInput(input1, {
                initialCountry: "in",
                separateDialCode: true,
                utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"
            });

            // Initialize intlTelInput for Phone Number 2
            var iti2 = window.intlTelInput(input2, {
                initialCountry: "in",
                separateDialCode: true,
                utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"
            });

            // Update hidden fields with the full phone number before form submission
            document.querySelector("#saveLeadBtn").addEventListener("click", function (e) {
                var fullPhoneNumber1 = iti1.getNumber();
                var fullPhoneNumber2 = iti2.getNumber();

                document.querySelector("#fullPhoneNumber").value = fullPhoneNumber1;
                document.querySelector("#fullPhoneNumber2").value = fullPhoneNumber2;
            });

            // Real-time validation for phone number 1
            document.querySelector("#phoneNumber").addEventListener("blur", function () {
                var phoneNumber = iti1.getNumber();
                validatePhoneNumber(phoneNumber);
            });

            // Real-time validation for phone number 2
            document.querySelector("#phoneNumber2").addEventListener("blur", function () {
                var phoneNumber2 = iti2.getNumber();
                validatePhoneNumber(phoneNumber2);
            });

            function validatePhoneNumber(phoneNumber) {
                $.ajax({
                    url: '/Admin/Lead/CheckPhoneNumber',
                    type: 'GET',
                    data: { phoneNumber: phoneNumber },
                    success: function (data) {
                        if (data.exists) {
                            alert("This lead already exists.");
                        }
                    },
                    error: function () {
                        console.log('Error checking phone number');
                    }
                });
            }

            // Real-time validation for First Name
            document.querySelector("#firstName").addEventListener("input", function () {
                var firstName = this.value;
                if (!/^[A-Za-z]*$/.test(firstName)) {
                    alert("First Name should only contain alphabets.");
                    this.value = firstName.replace(/[^A-Za-z]/g, '');
                }
            });

            // Real-time validation for Last Name
            document.querySelector("#lastName").addEventListener("input", function () {
                var lastName = this.value;
                if (!/^[A-Za-z]*$/.test(lastName)) {
                    alert("Last Name should only contain alphabets.");
                    this.value = lastName.replace(/[^A-Za-z]/g, '');
                }
            });

        });
    </script>

</div>

<div class="modal fade" id="editLeadModal" tabindex="-1" aria-labelledby="editLeadModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"><strong>Edit</strong> Lead</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editLeadForm" method="post" role="form">
                    <input type="hidden" id="editLeadId" name="leadId">

                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">First Name</label>
                            <input id="editFirstName" class="form-control" placeholder="Enter first name" type="text" name="firstName" />
                        </div>
                        <div class="col-md-6">
                            <label class="control-label">Last Name</label>
                            <input id="editLastName" class="form-control" placeholder="Enter last name" type="text" name="lastName" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Email</label>
                            <input id="editEmail" class="form-control" placeholder="Enter email" type="email" name="email" />
                        </div>
                        <div class="col-md-6">
                            <label class="control-label">Gender</label>
                            <select id="editGender" class="form-control" name="gender">
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="control-label">Phone Number</label>
                            <input id="editPhoneNumber" class="form-control" placeholder="Enter phone number" type="text" name="phoneNumber" />
                        </div>
                        <div class="col-md-6">
                            <label class="control-label">Lead Source</label>
                            <select id="editLeadSource" class="form-control" name="leadSource">
                                <option value="">Select lead source</option>
                                <option value="Social Media">Social Media</option>
                                <option value="Website">Website</option>
                                <option value="Event">Event</option>
                                <option value="Walk in">Walk in</option>
                                <option value="Partner/Referral">Partner/Referral</option>
                                <option value="Other">Other</option>
                            </select>

                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>City</label>
                                <input type="text" class="form-control" name="city" id="city" placeholder="City">

                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Notes</label>
                                <input type="text" class="form-control" name="notes" id="notes" placeholder="Notes">

                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="updateLeadBtn">Update</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<script>
     $(document).ready(function () {
         $('#leadTable').DataTable({
             "ajax": {
                 "url": "/Employee/MyLead/GetAllocatedLeadData",
                 "type": "GET",
                 "datatype": "json"
             },
             "columns": [
                 { "data": "fullName", "autoWidth": true },
                 { "data": "email", "autoWidth": true },
                 { "data": "gender", "autoWidth": true },
                 { "data": "phoneNumber", "autoWidth": true },
                 { "data": "city", "autoWidth": true },
                 {
                     "data": "followUpStatus",

                     "autoWidth": true,
                     "render": function (data, type, row) {
                         if (data === "Converted Lead") {
                             return '<span class="badge badge-pill bg-success">Converted Lead</span>';
                         } else if (data === "Dead Lead") {
                             return '<span class="badge badge-pill bg-danger">Dead Lead</span>';
                         } else if (data === "Cold Lead") {
                             return '<span class="badge badge-pill bg-dark">Cold Lead</span>';
                         } else if (data === "Future Lead") {
                             return '<span class="badge badge-pill bg-secondary">Future Lead</span>';
                         } else if (data === "Hot Lead") {
                             return '<span class="badge badge-pill bg-primary">Hot Lead</span>';
                         } else if (data === "Warm Lead") {
                             return '<span class="badge badge-pill bg-info">Warm Lead</span>';
                         } else {
                             return '<span class="badge badge-pill bg-warning">Pending Lead</span>';
                         }
                     }
                 },

                 {
                     "data": "leadId",
                     "render": function (data, type, row) {
                         return '' +
                             '<a class="edit-lead btn btn-link me-5 text-primary" ' +
                             'data-leadid="' + row.leadId + '" ' +
                             'data-firstname="' + row.firstName + '" ' +
                             'data-lastname="' + row.lastName + '" ' +
                             'data-email="' + row.email + '" ' +
                             'data-gender="' + row.gender + '" ' +
                             'data-phonenumber="' + row.phoneNumber + '" ' +
                             'data-leadsource="' + row.leadSource + '" ' +
                             'data-city="' + row.city + '" ' +
                             'data-notes="' + row.notes + '" ' +
                             'style="cursor: pointer;">' +
                             '<span class="icon-container">' +
                             '<i class="bi bi-pencil"></i>' +
                             '<span class="tooltip-text">Edit</span>' +
                             '</span></a> ' +

                             '<a class="delete-lead btn btn-link me-5 text-danger" ' +
                             'data-leadid="' + row.leadId + '" ' +
                             'style="cursor: pointer;">' +
                             '<span class="icon-container">' +
                             '<i class="bi bi-trash"></i>' +
                             '<span class="tooltip-text">Delete</span>' +
                             '</span></a>' +

                             '<a href="/Employee/MyLead/HistoryLead?leadId=' + row.leadId + '" ' +
                             'class="btn btn-link text-info">' +
                             '<i class="bi bi-clock"></i> View History</a>';
                     }
                 }


             ]
         });
           $('#leadSource').change(function() {
       if ($(this).val() === 'Other') {
         $('#show').show();
       } else {
         $('#show').hide();
       }
     });
     $('#leadTable').on('click', '.view-history', function() {
     var leadId = $(this).data('leadid');
    console.log('Lead ID:', leadId); // Add this line to check if leadId is correct

     $.ajax({
         url: '/Employee/MyLead/HistoryLead',
         type: 'Post',
         data: { leadId: leadId },
         success: function(response) {
             // Handle success
         },
         error: function(xhr, status, error) {
             console.error('AJAX Error:', error);
         }
     });
     });
         // Save lead button click event
         $('#saveLeadBtn').on('click', function () {
             // Clear previous validation errors
             $('.validation-error').remove();

             let isValid = true;

             // Validate First Name
             var firstName = $('#firstName').val().trim();
             var phoneNumber = $('#phoneNumber').val().trim();

             // Remove any existing validation errors
             $('.validation-error').remove();

             // Check if firstName is empty
             if (firstName === '') {
                 isValid = false;
                 $('#firstName').after('<span class="validation-error text-danger">First Name is required.</span>');
             } else if (firstName.length < 3) {
                 // Check if firstName has at least 3 characters
                 isValid = false;
                 $('#firstName').after('<span class="validation-error text-danger">First Name must be at least 3 characters long.</span>');
             } else if (/^\d/.test(firstName)) {
                 // Check if firstName starts with a number
                 isValid = false;
                 $('#firstName').after('<span class="validation-error text-danger">First Name cannot start with a number.</span>');
             }

             var lastName = $('#lastName').val().trim();


             // Check if firstName is empty
             if (lastName === '') {
                 isValid = false;
                 $('#lastName').after('<span class="validation-error text-danger">Last Name is required.</span>');
             } else if (lastName.length < 3) {
                 // Check if firstName has at least 3 characters
                 isValid = false;
                 $('#lastName').after('<span class="validation-error text-danger">Last Name must be at least 3 characters long.</span>');
             } else if (/^\d/.test(lastName)) {
                 // Check if firstName starts with a number
                 isValid = false;
                 $('#lastName').after('<span class="validation-error text-danger">Last Name cannot start with a number.</span>');
             }

             var city = $('#city').val().trim();


             // Check if firstName is empty
             if (city === '') {
                 isValid = false;
                 $('#city').after('<span class="validation-error text-danger">City  is required.</span>');
             } else if (city.length < 3) {
                 // Check if firstName has at least 3 characters
                 isValid = false;
                 $('#city').after('<span class="validation-error text-danger">City must be at least 3 characters long.</span>');
             } else if (/^\d/.test(city)) {
                 // Check if firstName starts with a number
                 isValid = false;
                 $('#city').after('<span class="validation-error text-danger">City cannot start with a number.</span>');
             }



             // Validate Email
             const email = $('#email').val().trim();
             const emailPattern = /^[^\s@@]+@@[^\s@@]+\.[^\s@@]+$/;
             if (email === '') {
                 isValid = false;
                 $('#email').after('<span class="validation-error text-danger">Email is required.</span>');
             } else if (!emailPattern.test(email)) {
                 isValid = false;
                 $('#email').after('<span class="validation-error text-danger">Invalid email format.</span>');
             }
             // Validate Phone Number

             // Validate Phone Number
             if ($('#gender').val().trim() === '') {
                 isValid = false;
                 $('#gender').after('<span class="validation-error text-danger">  Gender is required.</span>');
             }
             if ($('#leadSource').val().trim() === '') {
                 isValid = false;
                 $('#leadSource').after('<span class="validation-error text-danger">  Lead Source is required.</span>');
             }
             if (!isValid) {
                 return;
             }

             var form = $('#leadForm');
             $.ajax({
                 type: form.attr('method'),
                 url: '/Employee/MyLead/LeadForm', // Set the action URL here
                 data: form.serialize(),
                 success: function (response) {
                     console.log(response);
                     if (response.success) {
                         alert(response.message);
                         form[0].reset(); // Clear the form
                         $('#add-new-events').modal('hide');
                         $('#leadTable').DataTable().ajax.reload(); // Reload the data table
                     } else {

                     // Show error message if not successful
                     alert(response.message);

                     }
                 },
                 error: function (error) {
                     console.log(error); // Log the error for debugging
                     // alert('Failed to add lead');
                 }
             });
         });


         $(document).on('click', '.edit-lead', function () {
             // Get the data attributes from the clicked button
             const leadId = $(this).data('leadid');
             const firstName = $(this).data('firstname');
             const lastName = $(this).data('lastname');
             const email = $(this).data('email');
             const gender = $(this).data('gender');
             const phoneNumber = $(this).data('phonenumber');
             const leadSource = $(this).data('leadsource');
             const notes = $(this).data('notes');
             const city = $(this).data('city');

             // Populate the modal fields with the lead data
             $('#editLeadModal #editLeadId').val(leadId);
             $('#editLeadModal #editFirstName').val(firstName);
             $('#editLeadModal #editLastName').val(lastName);
             $('#editLeadModal #editEmail').val(email);
             $('#editLeadModal #editGender').val(gender);
             $('#editLeadModal #editPhoneNumber').val(phoneNumber);
             $('#editLeadModal #editLeadSource').val(leadSource);
             $('#editLeadModal #city').val(city);
             $('#editLeadModal #notes').val(notes);

             // Show the modal
             $('#editLeadModal').modal('show');
         });


         // Save edited lead



         $(document).on('click', '.delete-lead', function () {
             var leadId = $(this).data('leadid');
             if (confirm('Are you sure you want to delete this lead?')) {
                 // Perform the delete operation (AJAX request)
                 $.ajax({
                     url: '/Employee/MyLead/DeleteLead',
                     type: 'POST',
                     data: { id: leadId },
                     success: function (response) {
                         if (response.success) {
                             alert('Lead deleted successfully.');
                             $('#leadTable').DataTable().ajax.reload();
                         } else {
                             alert('Error deleting lead: ' + response.message);
                         }
                     },
                     error: function (error) {
                         alert('Error deleting lead: ' + error.statusText);
                     }
                 });
             }
         });
         // Save follow-up button click event
         $('#saveFollowUp').on('click', function () {
             debugger
             var form = $('#followUpForm');
             $.ajax({
                 type: form.attr('method'),
                 url: form.attr('action'),
                 data: form.serialize(),
                 success: function (response) {
                     console.log(response);
                     if (response.success) {
                         alert(response.message);
                         $('#followUpModal').modal('hide');
                         $('#leadTable').DataTable().ajax.reload(); // Reload the data table
                     } else {
                         alert(response.message);
                     }
                 },
                 error: function (error) {
                     console.log(error); // Log the error for debugging
                     alert('Failed to save follow-up');
                 }
             });
         });
         // Open modal and populate details
         $(document).on('click', '.open-modal', function () {
             var leadId = $(this).data('leadid');
             var fullName = $(this).data('fullname');

             // Set leadId and fullName in the modal form
             $('#followUpModal #leadId').val(leadId);
             $('#followUpModal #leadName').val(fullName);

             // Fetch follow-up data using AJAX
             $.ajax({
                 url: '/Employee/MyLead/GetFollowUpDetails', // Adjust the URL to your specific endpoint
                 type: 'GET',
                 data: { leadId: leadId },
                 success: function (response) {
                     if (response.success) {
                         // Populate the modal with the retrieved data
                         $('#followUpModal #leadStatus').val(response.data.status);
                         $('#followUpModal #reminderDate').val(response.data.reminderDate ? new Date(response.data.reminderDate).toISOString().substring(0, 10) : '');
                         $('#followUpModal #description').val(response.data.description);
                     } else {
                         // Clear the fields if no data is returned
                         $('#followUpModal #leadStatus').val('');
                         $('#followUpModal #reminderDate').val('');
                         $('#followUpModal #description').val('');
                     }
                 },
                 error: function (error) {
                     console.log(error); // Log the error for debugging
                     // Handle the error if needed
                 }
             });

             // Show the modal
             $('#followUpModal').modal('show');
         });



     });

     $(document).ready(function () {
         $('#updateLeadBtn').on('click', function (e) {
             e.preventDefault(); // Prevent default form submission
             var isValid = true;

             var firstName = $('#editFirstName').val().trim();
             var lastName = $('#editLastName').val().trim();
             var email = $('#editEmail').val().trim();
             var gender = $('#editGender').val().trim();

             var leadSource = $('#editLeadSource').val().trim();

             // Remove any existing validation errors
             $('.validation-error').remove();

             // Validate First Name
             if (firstName === '') {
                 isValid = false;
                 $('#editFirstName').after('<span class="validation-error text-danger">First Name is required.</span>');
             } else if (firstName.length < 3) {
                 isValid = false;
                 $('#editFirstName').after('<span class="validation-error text-danger">First Name must be at least 3 characters long.</span>');
             } else if (/^\d/.test(firstName)) {
                 isValid = false;
                 $('#editFirstName').after('<span class="validation-error text-danger">First Name cannot start with a number.</span>');
             }

             // Validate Last Name
             if (lastName === '') {
                 isValid = false;
                 $('#editLastName').after('<span class="validation-error text-danger">Last Name is required.</span>');
             } else if (lastName.length < 3) {
                 isValid = false;
                 $('#editLastName').after('<span class="validation-error text-danger">Last Name must be at least 3 characters long.</span>');
             } else if (/^\d/.test(lastName)) {
                 isValid = false;
                 $('#editLastName').after('<span class="validation-error text-danger">Last Name cannot start with a number.</span>');
             }

             // Validate Email
             const emailPattern = /^[^\s@@]+@@[^\s@@]+\.[^\s@@]+$/;
             if (email === '') {
                 isValid = false;
                 $('#editEmail').after('<span class="validation-error text-danger">Email is required.</span>');
             } else if (!emailPattern.test(email)) {
                 isValid = false;
                 $('#editEmail').after('<span class="validation-error text-danger">Invalid email format.</span>');
             }



             // Validate Gender
             if (gender === '') {
                 isValid = false;
                 $('#editGender').after('<span class="validation-error text-danger">Gender is required.</span>');
             }

             if (isValid) {
                 var form = $('#editLeadForm');
                 $.ajax({
                     type: 'POST',
                     url: '/Employee/MyLead/EditLead', // Replace with your actual endpoint
                     data: form.serialize(),
                     success: function (response) {
                         console.log(response);
                         if (response.success) {
                             alert(response.message);
                             $('#editLeadModal').modal('hide');
                             $('#leadTable').DataTable().ajax.reload(); // Reload the data table
                         } else {
                             alert(response.message);
                         }
                     },
                     error: function (error) {
                         console.log(error); // Log the error for debugging
                         alert('Failed to update lead');
                     }
                 });
             }
         });
     });

</script>